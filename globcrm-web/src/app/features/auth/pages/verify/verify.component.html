<div class="auth-container">
  <mat-card class="auth-card">
    <mat-card-header class="auth-card-header">
      <div class="brand-header">
        <h1 class="brand-title">GlobCRM</h1>
      </div>
    </mat-card-header>

    <mat-card-content>
      @if (state() === 'confirming') {
        <div class="state-content">
          <mat-spinner diameter="48"></mat-spinner>
          <h2>{{ 'auth.verify.verifying' | transloco }}</h2>
          <p class="state-subtitle">{{ 'auth.verify.verifyingSubtitle' | transloco }}</p>
        </div>
      }

      @if (state() === 'pending') {
        <div class="state-content">
          <mat-icon class="state-icon pending-icon">mark_email_unread</mat-icon>
          <h2>{{ 'auth.verify.checkEmail' | transloco }}</h2>
          <p class="state-subtitle">
            @if (email()) {
              {{ 'auth.verify.sentTo' | transloco }} <strong>{{ email() }}</strong>. {{ 'auth.verify.clickLink' | transloco }}
            } @else {
              {{ 'auth.verify.sentGeneric' | transloco }} {{ 'auth.verify.clickLink' | transloco }}
            }
          </p>

          <div class="resend-section">
            <p class="resend-text">{{ 'auth.verify.didntReceive' | transloco }}</p>
            @if (email()) {
              <button
                mat-stroked-button
                color="primary"
                (click)="resendVerification()"
                [disabled]="resendCooldown() > 0 || resendLoading()">
                @if (resendLoading()) {
                  <mat-spinner diameter="18"></mat-spinner>
                } @else if (resendCooldown() > 0) {
                  {{ 'auth.verify.resendIn' | transloco }} {{ resendCooldown() }}s
                } @else {
                  {{ 'auth.verify.resend' | transloco }}
                }
              </button>
            }
          </div>
        </div>
      }

      @if (state() === 'confirmed') {
        <div class="state-content">
          <mat-icon class="state-icon success-icon">check_circle</mat-icon>
          <h2>{{ 'auth.verify.verified' | transloco }}</h2>
          <p class="state-subtitle">{{ 'auth.verify.verifiedMessage' | transloco }}</p>
          <a mat-flat-button color="primary" routerLink="/auth/login" [queryParams]="{ email: email() }" class="action-button">
            {{ 'auth.verify.goToLogin' | transloco }}
          </a>
        </div>
      }

      @if (state() === 'error') {
        <div class="state-content">
          <mat-icon class="state-icon error-icon">error</mat-icon>
          <h2>{{ 'auth.verify.verificationFailed' | transloco }}</h2>
          <p class="state-subtitle">{{ errorMessage() }}</p>

          <div class="error-actions">
            @if (email()) {
              <button
                mat-stroked-button
                color="primary"
                (click)="resendVerification()"
                [disabled]="resendCooldown() > 0 || resendLoading()">
                @if (resendLoading()) {
                  <mat-spinner diameter="18"></mat-spinner>
                } @else if (resendCooldown() > 0) {
                  {{ 'auth.verify.resendIn' | transloco }} {{ resendCooldown() }}s
                } @else {
                  {{ 'auth.verify.resend' | transloco }}
                }
              </button>
            }
            <a mat-button routerLink="/auth/login" [queryParams]="{ email: email() }">{{ 'auth.verify.backToLogin' | transloco }}</a>
          </div>
        </div>
      }
    </mat-card-content>
  </mat-card>
</div>
