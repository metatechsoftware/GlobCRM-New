<div class="pm-matrix">
  <p class="pm-hint">
    Set access levels for each entity type. Scopes: <strong>None</strong> (no access), <strong>Own</strong> (created by user),
    <strong>Team</strong> (same team), or <strong>All</strong> (full access).
  </p>

  <div class="pm-container">
    <table class="pm-table">
      <thead>
        <tr>
          <th class="pm-entity-header">
            <mat-icon class="pm-entity-header__icon">category</mat-icon>
            Entity
          </th>
          @for (op of operations; track op) {
            <th class="pm-op-header">
              <div class="pm-op-header__content">
                <mat-icon class="pm-op-header__icon">{{ getOperationIcon(op) }}</mat-icon>
                <span>{{ op }}</span>
                <mat-form-field appearance="outline" class="pm-quick-set">
                  <mat-label>Set all</mat-label>
                  <mat-select
                    [value]="getQuickSetValue(op)"
                    (selectionChange)="onQuickSet(op, $event.value)"
                  >
                    @for (scope of scopes; track scope) {
                      <mat-option [value]="scope">
                        {{ scopeLabels[scope] }}
                      </mat-option>
                    }
                  </mat-select>
                </mat-form-field>
              </div>
            </th>
          }
        </tr>
      </thead>
      <tbody>
        @for (entity of entityTypes; track entity; let i = $index) {
          <tr class="pm-row" [style.animation-delay]="(i * 40) + 'ms'">
            <td class="pm-entity-name">
              <mat-icon class="pm-entity-icon" [style.color]="getEntityColor(entity)">{{ getEntityIcon(entity) }}</mat-icon>
              {{ entity }}
            </td>
            @for (op of operations; track op) {
              <td class="pm-cell" [class]="'pm-cell--' + getScope(entity, op)">
                <mat-form-field appearance="outline" class="pm-scope-select">
                  <mat-select
                    [value]="getScope(entity, op)"
                    (selectionChange)="onCellChange(entity, op, $event.value)"
                    [panelClass]="'pm-scope-panel'"
                  >
                    @for (scope of scopes; track scope) {
                      <mat-option [value]="scope" [class]="getScopeClass(scope)">
                        {{ scopeLabels[scope] }}
                      </mat-option>
                    }
                  </mat-select>
                </mat-form-field>
              </td>
            }
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
