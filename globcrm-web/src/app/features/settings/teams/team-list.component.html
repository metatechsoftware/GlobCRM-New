<div class="team-list-container">
  <div class="page-header">
    <h1>Team Management</h1>
    <button mat-flat-button color="primary" routerLink="/settings/teams/new">
      <mat-icon>add</mat-icon>
      Create Team
    </button>
  </div>

  @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner diameter="48"></mat-spinner>
      <p>Loading teams...</p>
    </div>
  } @else if (errorMessage()) {
    <div class="error-container">
      <mat-icon class="error-icon">error_outline</mat-icon>
      <p>{{ errorMessage() }}</p>
      <button mat-flat-button color="primary" (click)="loadTeams()">
        <mat-icon>refresh</mat-icon>
        Retry
      </button>
    </div>
  } @else {
    <table mat-table [dataSource]="teams()" class="teams-table">
      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let team">{{ team.name }}</td>
      </ng-container>

      <!-- Description Column -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let team" class="description-cell">
          {{ team.description || '-' }}
        </td>
      </ng-container>

      <!-- Default Role Column -->
      <ng-container matColumnDef="defaultRoleName">
        <th mat-header-cell *matHeaderCellDef>Default Role</th>
        <td mat-cell *matCellDef="let team">
          @if (team.defaultRoleName) {
            <mat-chip-set>
              <mat-chip>{{ team.defaultRoleName }}</mat-chip>
            </mat-chip-set>
          } @else {
            <span class="no-role">None</span>
          }
        </td>
      </ng-container>

      <!-- Member Count Column -->
      <ng-container matColumnDef="memberCount">
        <th mat-header-cell *matHeaderCellDef>Members</th>
        <td mat-cell *matCellDef="let team">{{ team.memberCount }}</td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let team">
          <div class="action-buttons">
            <button
              mat-icon-button
              (click)="onEdit(team)"
              matTooltip="Edit team"
            >
              <mat-icon>edit</mat-icon>
            </button>
            <button
              mat-icon-button
              color="warn"
              (click)="onDelete(team)"
              matTooltip="Delete team"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

      <!-- No data row -->
      <tr class="mat-mdc-no-data-row" *matNoDataRow>
        <td [attr.colspan]="displayedColumns.length" class="no-data-cell">
          No teams found. Create your first team to get started.
        </td>
      </tr>
    </table>
  }
</div>
