---
phase: 29-integration-marketplace
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - globcrm-web/src/app/features/settings/integrations/integration-catalog.ts
  - globcrm-web/src/app/features/settings/integrations/integration.models.ts
  - globcrm-web/src/app/features/settings/integrations/integration-card.component.ts
  - globcrm-web/src/app/features/settings/integrations/integration-marketplace.component.ts
  - globcrm-web/src/app/features/settings/integrations/integration-marketplace.component.scss
  - globcrm-web/src/assets/icons/integrations/slack.svg
  - globcrm-web/src/assets/icons/integrations/gmail.svg
  - globcrm-web/src/assets/icons/integrations/google-calendar.svg
  - globcrm-web/src/assets/icons/integrations/quickbooks.svg
  - globcrm-web/src/assets/icons/integrations/mailchimp.svg
  - globcrm-web/src/assets/icons/integrations/dropbox.svg
  - globcrm-web/src/assets/icons/integrations/github.svg
  - globcrm-web/src/assets/icons/integrations/zapier.svg
  - globcrm-web/src/assets/icons/integrations/hubspot.svg
  - globcrm-web/src/assets/icons/integrations/twilio.svg
  - globcrm-web/src/assets/icons/integrations/whatsapp.svg
  - globcrm-web/src/assets/icons/integrations/instagram.svg
autonomous: true
requirements:
  - INTG-01
  - INTG-02
  - INTG-03
  - INTG-11

must_haves:
  truths:
    - "User sees a responsive card grid of 12 integrations with logos, names, descriptions, and status badges"
    - "User can filter integrations by category using horizontal chip bar"
    - "User can search integrations by name with real-time filtering"
    - "Popular integrations display a 'Popular' badge on their cards"
    - "Connected integrations display a status badge and green left-border accent"
  artifacts:
    - path: "globcrm-web/src/app/features/settings/integrations/integration-catalog.ts"
      provides: "INTEGRATION_CATALOG constant with 12 curated integrations"
      contains: "INTEGRATION_CATALOG"
    - path: "globcrm-web/src/app/features/settings/integrations/integration.models.ts"
      provides: "TypeScript interfaces for catalog items, categories, credential fields"
      contains: "IntegrationCatalogItem"
    - path: "globcrm-web/src/app/features/settings/integrations/integration-card.component.ts"
      provides: "Individual integration card component"
      contains: "IntegrationCardComponent"
    - path: "globcrm-web/src/app/features/settings/integrations/integration-marketplace.component.ts"
      provides: "Main marketplace page with grid, search, and category filter"
      contains: "IntegrationMarketplaceComponent"
  key_links:
    - from: "integration-marketplace.component.ts"
      to: "integration-catalog.ts"
      via: "imports INTEGRATION_CATALOG constant"
      pattern: "INTEGRATION_CATALOG"
    - from: "integration-marketplace.component.ts"
      to: "integration-card.component.ts"
      via: "@for loop rendering cards"
      pattern: "app-integration-card"
---

<objective>
Create the frontend integration marketplace page with a responsive card grid, 12 brand SVG icons, category chip filter, and name search. This plan builds the static catalog and visual layout -- no API calls yet.

Purpose: The marketplace page is the primary user interface for browsing integrations. The card grid, filtering, and search are independent of backend API (catalog data is a frontend constant). Building this in parallel with backend Plan 01 maximizes efficiency.
Output: Integration marketplace page with 12 integration cards, category filter, search, brand icons, and responsive grid layout.
</objective>

<execution_context>
@C:/Users/maliy/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/maliy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-integration-marketplace/29-CONTEXT.md
@.planning/phases/29-integration-marketplace/29-RESEARCH.md

@globcrm-web/src/app/features/settings/settings-hub.component.ts (grid layout pattern reference)
@globcrm-web/src/app/features/settings/settings.routes.ts (route registration)
@globcrm-web/src/styles/tokens.css (design tokens)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create integration models, catalog constant, and SVG brand icons</name>
  <files>
    globcrm-web/src/app/features/settings/integrations/integration.models.ts
    globcrm-web/src/app/features/settings/integrations/integration-catalog.ts
    globcrm-web/src/assets/icons/integrations/slack.svg
    globcrm-web/src/assets/icons/integrations/gmail.svg
    globcrm-web/src/assets/icons/integrations/google-calendar.svg
    globcrm-web/src/assets/icons/integrations/quickbooks.svg
    globcrm-web/src/assets/icons/integrations/mailchimp.svg
    globcrm-web/src/assets/icons/integrations/dropbox.svg
    globcrm-web/src/assets/icons/integrations/github.svg
    globcrm-web/src/assets/icons/integrations/zapier.svg
    globcrm-web/src/assets/icons/integrations/hubspot.svg
    globcrm-web/src/assets/icons/integrations/twilio.svg
    globcrm-web/src/assets/icons/integrations/whatsapp.svg
    globcrm-web/src/assets/icons/integrations/instagram.svg
  </files>
  <action>
    Create `integration.models.ts` with TypeScript interfaces:

    ```typescript
    export type IntegrationCategory = 'communication' | 'accounting' | 'marketing' | 'storage' | 'calendar' | 'developer-tools';

    export interface CredentialFieldDef {
      key: string;
      label: string;
      type: 'password' | 'text';
      required: boolean;
      placeholder?: string;
    }

    export interface IntegrationCatalogItem {
      key: string;              // slug: 'slack', 'gmail', etc.
      name: string;
      description: string;
      category: IntegrationCategory;
      iconPath: string;         // path to SVG in assets
      brandColor: string;       // hex color for accent
      isPopular: boolean;
      credentialFields: CredentialFieldDef[];
    }

    export interface IntegrationConnection {
      id: string;
      integrationKey: string;
      status: 'Connected' | 'Disconnected';
      credentialMask: string | null;
      connectedByUserId: string | null;
      connectedAt: string | null;
      disconnectedAt: string | null;
    }

    export interface IntegrationActivityLogEntry {
      id: string;
      action: string;
      performedByUserName: string;
      details: string | null;
      createdAt: string;
    }

    // Combined view model merging catalog + connection state
    export interface IntegrationViewModel {
      catalog: IntegrationCatalogItem;
      connection: IntegrationConnection | null;
      isConnected: boolean;
    }
    ```

    Create `integration-catalog.ts` with `INTEGRATION_CATALOG` constant array of 12 items. Use these exact integrations per CONTEXT.md decisions:

    1. **Slack** - Communication, popular, brand color #4A154B, credential: Bot Token (password)
    2. **Gmail** - Communication, popular, brand color #EA4335, credential: API Key (password)
    3. **Google Calendar** - Calendar, popular, brand color #4285F4, credential: API Key (password)
    4. **QuickBooks** - Accounting, not popular, brand color #2CA01C, credentials: Client ID (text) + Client Secret (password)
    5. **Mailchimp** - Marketing, popular, brand color #FFE01B, credential: API Key (password)
    6. **Dropbox** - Storage, not popular, brand color #0061FF, credential: Access Token (password)
    7. **GitHub** - Developer Tools, not popular, brand color #181717, credential: Personal Access Token (password)
    8. **Zapier** - Developer Tools, not popular, brand color #FF4A00, credentials: API Key (password) + Webhook URL (text)
    9. **HubSpot** - Marketing, not popular, brand color #FF7A59, credential: API Key (password)
    10. **Twilio** - Communication, not popular, brand color #F22F46, credentials: Account SID (text) + Auth Token (password)
    11. **WhatsApp** - Communication, popular, brand color #25D366, credential: Business API Token (password)
    12. **Instagram** - Communication, not popular, brand color #E4405F, credential: Access Token (password)

    Each item includes a short 1-line `description` like "Team messaging and collaboration platform" for Slack.

    Create 12 SVG brand icon files in `globcrm-web/src/assets/icons/integrations/`. Each SVG should be a simple, recognizable brand icon with:
    - ViewBox: `0 0 24 24`
    - Single path element (simplified brand mark)
    - Fill set to the brand color
    - No width/height attributes (controlled by CSS)

    Source SVG paths from Simple Icons (https://simpleicons.org/). Each icon is a single `<svg>` with one `<path>`. Keep files minimal (~1-2KB each).
  </action>
  <verify>Verify all 12 SVG files exist in `globcrm-web/src/assets/icons/integrations/`. Verify `integration-catalog.ts` exports `INTEGRATION_CATALOG` with exactly 12 items. Verify `integration.models.ts` exports all interfaces.</verify>
  <done>12 brand SVG icons in assets folder. INTEGRATION_CATALOG constant with 12 curated integrations including name, description, category, brand color, popularity flag, and credential field definitions. All TypeScript interfaces defined for catalog, connection, activity log, and view model.</done>
</task>

<task type="auto">
  <name>Task 2: Create marketplace page with card grid, category filter, and search</name>
  <files>
    globcrm-web/src/app/features/settings/integrations/integration-card.component.ts
    globcrm-web/src/app/features/settings/integrations/integration-marketplace.component.ts
    globcrm-web/src/app/features/settings/integrations/integration-marketplace.component.scss
  </files>
  <action>
    Create `IntegrationCardComponent` (standalone, OnPush):
    - Inputs: `catalog` (IntegrationCatalogItem, required), `connection` (IntegrationConnection | null), `isAdmin` (boolean)
    - Outputs: `connect` (EventEmitter), `viewDetails` (EventEmitter)
    - Template:
      - Card with Material elevation (mat-card or custom card div)
      - Green left-border accent (`border-left: 3px solid var(--color-success)`) when connected -- per locked decision
      - Brand icon loaded via `<img [src]="catalog.iconPath" [alt]="catalog.name">` with 40x40px size, `object-fit: contain`
      - Integration name as card title
      - Short description (1-2 lines, text-ellipsis if overflow)
      - Status badge: "Connected" (green chip) or "Not Connected" (gray chip) using small mat-chip or CSS badge
      - "Popular" badge (small orange/amber chip) if `catalog.isPopular` -- per locked decision
      - Connect button (mat-raised-button, primary color) visible ONLY for admins AND not connected -- per locked decision
      - "View Details" text button always visible
    - Styles: Card min-height ~180px, padding consistent with settings hub cards

    Create `IntegrationMarketplaceComponent` (standalone, OnPush):
    - Imports: MatFormField, MatInput, MatChipListbox, MatChipOption, IntegrationCardComponent, TranslocoPipe
    - Inject: `AuthStore` (to check admin role for card buttons)
    - Signals:
      - `searchQuery = signal('')`
      - `selectedCategory = signal<IntegrationCategory | 'all'>('all')`
      - `connections = signal<IntegrationConnection[]>([])` (empty initially -- populated by Plan 04)
    - Computed signals:
      - `integrations = computed(() => { ... })` -- merges INTEGRATION_CATALOG with connections signal, applies search + category filters, returns `IntegrationViewModel[]`
      - `isAdmin = computed(() => this.authStore.userRole() === 'Admin')`
      - `categories` -- constant array: `['all', 'communication', 'accounting', 'marketing', 'storage', 'calendar', 'developer-tools']` with display labels
    - Template layout:
      - Page header: "Integrations" title
      - Filter bar row:
        - Search input (mat-form-field with mat-icon prefix "search") -- debounced input updates `searchQuery`
        - Category chip bar (MatChipListbox, single select) with "All" + 6 category chips
      - Card grid: CSS Grid with `grid-template-columns: repeat(auto-fill, minmax(280px, 1fr))`, gap 16px -- per locked decision for responsive auto-fit
      - `@for (integration of integrations(); track integration.catalog.key)` renders IntegrationCardComponent
      - Empty state: "No integrations found" message when filtered list is empty
    - Filter logic in computed signal:
      - If selectedCategory !== 'all', filter by `catalog.category === selectedCategory`
      - If searchQuery is not empty, filter by `catalog.name.toLowerCase().includes(searchQuery.toLowerCase())`
      - Both filters combine (AND logic)

    Create SCSS file `integration-marketplace.component.scss`:
    - `.marketplace-header` with page title styling
    - `.filter-bar` with flex layout, gap between search and chips
    - `.integration-grid` with CSS Grid (`auto-fill, minmax(280px, 1fr)`, gap: 16px)
    - `.integration-card` with transition on border-left for connected state
    - `.connected-card` with `border-left: 3px solid var(--color-success)`
    - `.status-badge` green/gray variants
    - `.popular-badge` amber/orange variant
    - Responsive: on mobile (< 600px), cards go full-width single column

    Do NOT add the route to settings.routes.ts yet -- that will be done in Plan 05 along with settings hub card.
  </action>
  <verify>Run `cd C:/Users/maliy/Documents/MetaTech/Projects/GlobCRM-New/globcrm-web && npx ng build --configuration development 2>&1 | head -20` -- must compile without errors. Note: the component is not routed yet, so it only needs to compile, not be visually testable.</verify>
  <done>IntegrationCardComponent renders individual integration cards with brand icon, name, description, status badge, popular badge, and admin-only connect button with green left-border accent on connected cards. IntegrationMarketplaceComponent displays responsive auto-fit grid with search input and category chip filter. All filtering is client-side computed signal. Compiles cleanly.</done>
</task>

</tasks>

<verification>
- `ng build --configuration development` compiles without errors
- INTEGRATION_CATALOG has exactly 12 entries matching the user-specified list
- Popular flag set on exactly: Slack, Gmail, WhatsApp, Mailchimp, Google Calendar
- Categories match: Communication, Accounting, Marketing, Storage, Calendar, Developer Tools
- All 12 SVG files exist in assets/icons/integrations/
- Card component has green left-border for connected state
- Grid uses `auto-fill, minmax(280px, 1fr)` responsive pattern
</verification>

<success_criteria>
Marketplace page displays 12 integration cards in a responsive grid. Each card shows brand icon, name, description, status badge, and popular badge where applicable. Category chip filter and search input filter the grid in real-time. Connected cards show green left-border accent. Admin-only connect button visible on cards. Compiles cleanly (not routed yet).
</success_criteria>

<output>
After completion, create `.planning/phases/29-integration-marketplace/29-03-SUMMARY.md`
</output>
