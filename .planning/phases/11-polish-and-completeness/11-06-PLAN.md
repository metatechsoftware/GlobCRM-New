---
phase: 11-polish-and-completeness
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - globcrm-web/src/app/shared/components/navbar/navbar.component.ts
  - globcrm-web/src/app/shared/components/navbar/navbar.component.html
  - globcrm-web/src/app/shared/components/navbar/navbar.component.scss
  - globcrm-web/src/app/shared/components/dynamic-table/dynamic-table.component.scss
  - globcrm-web/src/styles.scss
autonomous: true
must_haves:
  truths:
    - "Navbar uses hamburger menu with MatSidenav on screens below 768px"
    - "Navbar renders inline links on desktop (above 768px) as before"
    - "DynamicTable is usable on tablet screens with horizontal scroll when needed"
    - "Entity detail pages stack tabs vertically or use scrollable tab strip on mobile"
    - "Core navigation (all nav links) is accessible on mobile via the hamburger menu"
    - "Web app works on Chrome, Firefox, Safari, and Edge desktop browsers"
  artifacts:
    - path: "globcrm-web/src/app/shared/components/navbar/navbar.component.ts"
      provides: "Responsive navbar with BreakpointObserver signal for mobile detection"
      contains: "isMobile|BreakpointObserver"
    - path: "globcrm-web/src/app/shared/components/navbar/navbar.component.html"
      provides: "Conditional rendering: hamburger menu on mobile, inline links on desktop"
      contains: "mat-sidenav|hamburger|isMobile"
    - path: "globcrm-web/src/app/shared/components/navbar/navbar.component.scss"
      provides: "Responsive styles for mobile navbar, sidenav, and breakpoint refinements"
      contains: "sidenav|drawer|mobile"
  key_links:
    - from: "navbar.component.ts"
      to: "BreakpointObserver"
      via: "CDK layout injection for responsive signals"
      pattern: "BreakpointObserver|isMobile"
    - from: "navbar.component.html"
      to: "MatSidenavModule"
      via: "Sidenav for mobile navigation drawer"
      pattern: "mat-sidenav|mat-drawer"
---

<objective>
Make the Angular web app responsive on tablet and mobile screens. Implement a hamburger menu for the navbar on mobile, ensure DynamicTable scrolls horizontally on smaller screens, and refine layouts for tablet breakpoints.

Purpose: Delivers RESP-01 (desktop browsers), RESP-02 (tablet responsive), RESP-03 (mobile navigation).
Output: Responsive navbar with hamburger menu, tablet-friendly table layouts, mobile-optimized entity views.
</objective>

<execution_context>
@/Users/metatech/.claude/get-shit-done/workflows/execute-plan.md
@/Users/metatech/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-polish-and-completeness/11-RESEARCH.md

@globcrm-web/src/app/shared/components/navbar/navbar.component.ts
@globcrm-web/src/app/shared/components/navbar/navbar.component.html
@globcrm-web/src/app/shared/components/navbar/navbar.component.scss
@globcrm-web/src/app/shared/components/dynamic-table/dynamic-table.component.scss
@globcrm-web/src/styles.scss
</context>

<tasks>

<task type="auto">
  <name>Task 1: Responsive navbar with hamburger menu on mobile</name>
  <files>
    globcrm-web/src/app/shared/components/navbar/navbar.component.ts
    globcrm-web/src/app/shared/components/navbar/navbar.component.html
    globcrm-web/src/app/shared/components/navbar/navbar.component.scss
  </files>
  <action>
    Update NavbarComponent class:
    - Import BreakpointObserver from '@angular/cdk/layout' and toSignal from '@angular/core/rxjs-interop'
    - Import map from 'rxjs'
    - Create isMobile signal:
      ```typescript
      private breakpointObserver = inject(BreakpointObserver);
      isMobile = toSignal(
        this.breakpointObserver.observe(['(max-width: 768px)'])
          .pipe(map(result => result.matches)),
        { initialValue: false }
      );
      ```
    - Add sidenavOpen signal: `sidenavOpen = signal(false)`
    - Add toggleSidenav() method: `this.sidenavOpen.update(v => !v)`
    - Add closeSidenav() method: `this.sidenavOpen.set(false)`
    - Import MatSidenavModule in component imports array

    Update navbar.component.html:
    - Wrap the entire navbar in a conditional structure:
    - On desktop (not isMobile): render current navbar as-is (inline links)
    - On mobile (isMobile): replace the navbar__links div with a hamburger button (mat-icon-button with "menu" icon)
    - Add a mat-sidenav-container below/around the navbar:
      - mat-sidenav: contains all nav links in vertical list layout, mode="over", position="start", opened bound to sidenavOpen
      - Each link in sidenav: clicking closes sidenav via (click)="closeSidenav()"
      - Sidenav links styled as vertical list with icon + text, larger touch targets (48px min height)

    Actually, the better UX pattern for a mobile CRM is:
    - Keep the navbar as a top bar with brand + hamburger button + search + notifications + user menu
    - Hamburger opens a side drawer (mat-sidenav) with all nav links vertically
    - The main content is inside mat-sidenav-content

    Implementation approach:
    1. The navbar template should have two modes:
       - Desktop: current layout with inline links
       - Mobile: compact bar with brand mark + hamburger + spacer + search + notifications + user menu
    2. Use @if (isMobile()) to conditionally render
    3. The mobile sidenav should be a mat-drawer or mat-sidenav that slides in from the left
    4. Nav links in sidenav: vertical list with mat-icon + link text, routerLink, routerLinkActive for active state
    5. Sidenav closes on link click and on backdrop click

    Note: MatSidenav needs to wrap the main content area, which means the sidenav container might need to be at the app.component level. However, to keep changes minimal, use the "overlay" approach:
    - In navbar.component.html, add a fixed-position overlay drawer that appears on top of content
    - Use CSS positioning (fixed, left: 0, top: 56px, z-index: var(--z-overlay)) for the mobile drawer
    - This avoids restructuring app.component.html

    Alternative simpler approach: Use mat-menu as a dropdown from the hamburger button. It's simpler but less standard for navigation. Stick with a custom slide-in drawer using CSS transform for simplicity.

    Simplest working approach:
    - On mobile, replace navbar__links with hamburger button
    - Hamburger toggles a mobile-nav-drawer div that is absolutely positioned below navbar
    - Drawer slides in from left (CSS transform), contains all nav links vertically
    - Clicking a link or clicking outside closes the drawer
    - This requires no app.component changes

    Update navbar.component.scss:
    - Add .navbar__hamburger styles (display: none on desktop, flex on mobile)
    - Add .navbar__mobile-drawer styles: fixed position, left: 0, top: 56px, bottom: 0, width: 280px, background: var(--color-surface), box-shadow, z-index: var(--z-overlay), transform: translateX(-100%) by default, translateX(0) when open
    - Add .navbar__mobile-backdrop: fixed overlay behind drawer for click-to-close
    - Add .navbar__mobile-link styles: flex row, 48px min-height, padding, icon + text, hover/active states matching desktop link styles but larger
    - Remove the existing max-width: 640px breakpoint that tries to shrink all links (it doesn't work with 13+ links anyway)
    - Keep max-width: 1024px for user-info hide and max-width: 768px for org-badge hide
    - At max-width: 768px: hide .navbar__links, show hamburger button
  </action>
  <verify>
    `cd globcrm-web && npx ng build --configuration development 2>&1 | tail -5` -- builds successfully.
  </verify>
  <done>Navbar renders inline links on desktop (>768px) and a hamburger menu with slide-in drawer on mobile (<=768px). All 12+ nav links accessible on mobile via the drawer. Drawer closes on link click and backdrop click.</done>
</task>

<task type="auto">
  <name>Task 2: Responsive table, entity pages, and global style refinements</name>
  <files>
    globcrm-web/src/app/shared/components/dynamic-table/dynamic-table.component.scss
    globcrm-web/src/styles.scss
  </files>
  <action>
    Update dynamic-table.component.scss for tablet/mobile responsiveness:
    - Add horizontal scroll wrapper: the table container should have overflow-x: auto on screens below 1024px
    - Set min-width on the table element (e.g., 800px) so it maintains readability and scrolls horizontally rather than squishing columns
    - On tablet (768px-1024px): reduce cell padding, smaller font size
    - On mobile (<768px): table scrolls horizontally with a visual scroll hint (gradient fade on right edge)
    - Column resize handles: hide on touch screens (pointer: coarse media query) since they don't work well with touch
    - Filter panel: stack vertically on mobile (flex-direction: column at <768px)

    Update styles.scss for global responsive improvements:
    - Entity detail pages: at max-width 768px, reduce padding, let content flow full-width
    - Form layouts: at max-width 768px, stack form fields vertically (if they use flex-row, switch to column)
    - Mat-tab-group: ensure tab labels don't overflow on small screens (scrollable tab header is default in Angular Material, verify it works)
    - Mat-dialog: on mobile (<768px), dialogs should be near-full-width (max-width: calc(100vw - 32px))
    - Card layouts: reduce padding on mobile, stack horizontal layouts vertically
    - Page headers (title + action buttons): flex-wrap on mobile so buttons go below title

    Add responsive utility classes (if not already present):
    - .hide-mobile: display: none at max-width: 768px
    - .hide-tablet: display: none at max-width: 1024px
    - .show-mobile-only: display: none on desktop, display: block/flex on mobile

    Ensure all existing entity list pages (which use a common layout pattern) benefit from the DynamicTable responsive update without individual changes.

    Test that existing responsive breakpoints (1024px, 768px, 640px) still work correctly with the new additions.
  </action>
  <verify>
    `cd globcrm-web && npx ng build --configuration development 2>&1 | tail -5` -- builds successfully.
  </verify>
  <done>DynamicTable scrolls horizontally on tablet/mobile with maintained readability. Entity pages, forms, and dialogs adapt to smaller screens. Global responsive utilities available. No individual entity page changes needed.</done>
</task>

</tasks>

<verification>
- `ng build` succeeds
- Navbar shows hamburger menu on screens <= 768px
- Hamburger opens drawer with all nav links
- Drawer closes on link click
- DynamicTable scrolls horizontally on tablet
- Entity detail pages are usable on tablet width (768px-1024px)
- Forms stack vertically on mobile
- No horizontal overflow/scrollbar on the page body itself
</verification>

<success_criteria>
Web app is responsive at three breakpoints: desktop (>1024px, full layout), tablet (768-1024px, compact with horizontal scroll tables), mobile (<768px, hamburger menu with drawer navigation). All core pages accessible and usable on all screen sizes.
</success_criteria>

<output>
After completion, create `.planning/phases/11-polish-and-completeness/11-06-SUMMARY.md`
</output>
