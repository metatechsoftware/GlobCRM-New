---
phase: 24-my-day-personal-dashboard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - globcrm-web/src/app/app.routes.ts
  - globcrm-web/src/app/features/my-day/my-day.routes.ts
  - globcrm-web/src/app/features/my-day/my-day.component.ts
  - globcrm-web/src/app/shared/components/navbar/navbar.component.ts
  - globcrm-web/src/app/features/auth/pages/login/login.component.ts
  - globcrm-web/src/app/features/auth/pages/two-factor/two-factor.component.ts
autonomous: true
requirements:
  - MYDAY-01
  - MYDAY-09

must_haves:
  truths:
    - "After login, user lands on /my-day (not /dashboard)"
    - "Sidebar navigation shows 'My Day' with home icon as the first item and 'Analytics' as a separate menu item replacing 'Dashboard'"
    - "Navigating to /dashboard redirects to /analytics"
    - "Navigating to / redirects to /my-day"
    - "Existing org dashboard is fully accessible at /analytics"
  artifacts:
    - path: "globcrm-web/src/app/features/my-day/my-day.routes.ts"
      provides: "My Day feature route definition"
      contains: "MY_DAY_ROUTES"
    - path: "globcrm-web/src/app/features/my-day/my-day.component.ts"
      provides: "Placeholder My Day page component"
      contains: "MyDayComponent"
    - path: "globcrm-web/src/app/app.routes.ts"
      provides: "Restructured routes with /my-day default and /analytics for org dashboard"
      contains: "my-day"
  key_links:
    - from: "globcrm-web/src/app/app.routes.ts"
      to: "globcrm-web/src/app/features/my-day/my-day.routes.ts"
      via: "lazy-loaded route"
      pattern: "loadChildren.*my-day"
    - from: "globcrm-web/src/app/app.routes.ts"
      to: "globcrm-web/src/app/features/dashboard/dashboard.routes.ts"
      via: "analytics route"
      pattern: "path.*analytics.*DASHBOARD_ROUTES"
---

<objective>
Restructure application routing so /my-day is the default landing page after login, relocate the existing org dashboard to /analytics, and update sidebar navigation to reflect the new structure.

Purpose: This is the foundational route change that makes My Day the default experience. Must happen first so subsequent plans build the My Day page content without routing conflicts.
Output: Working route structure with /my-day as default, /analytics for org dashboard, backward-compatible /dashboard redirect, updated navbar, and a placeholder My Day component.
</objective>

<execution_context>
@/Users/metatech/.claude/get-shit-done/workflows/execute-plan.md
@/Users/metatech/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@globcrm-web/src/app/app.routes.ts
@globcrm-web/src/app/shared/components/navbar/navbar.component.ts
@globcrm-web/src/app/features/auth/pages/login/login.component.ts
@globcrm-web/src/app/features/auth/pages/two-factor/two-factor.component.ts
@globcrm-web/src/app/features/dashboard/dashboard.routes.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create My Day placeholder component and route, restructure app routes</name>
  <files>
    globcrm-web/src/app/features/my-day/my-day.routes.ts
    globcrm-web/src/app/features/my-day/my-day.component.ts
    globcrm-web/src/app/app.routes.ts
  </files>
  <action>
    1. Create `globcrm-web/src/app/features/my-day/my-day.component.ts` as a minimal standalone component:
       - selector: 'app-my-day'
       - ChangeDetectionStrategy.OnPush
       - Template: simple centered text "My Day — Coming Soon" (placeholder for 24-03)
       - No providers, no store yet

    2. Create `globcrm-web/src/app/features/my-day/my-day.routes.ts`:
       - Export `MY_DAY_ROUTES: Routes` array
       - Single route: `{ path: '', component: MyDayComponent }`

    3. Update `globcrm-web/src/app/app.routes.ts`:
       - Add `/my-day` route with `canActivate: [authGuard]`, lazy-loading `MY_DAY_ROUTES`
       - Change existing `/dashboard` path to `/analytics` (keep same `canActivate: [authGuard]`, same lazy-load of `DASHBOARD_ROUTES`)
       - Add redirect: `{ path: 'dashboard', redirectTo: 'analytics', pathMatch: 'full' }` for backward compatibility
       - Change default redirect: `{ path: '', redirectTo: 'my-day', pathMatch: 'full' }`
       - Change wildcard redirect: `{ path: '**', redirectTo: 'my-day' }`
       - Place the `/my-day` route BEFORE entity routes (after auth/onboarding)
       - Place the `dashboard` redirect AFTER `/analytics` route but BEFORE the default '' redirect
       - IMPORTANT: Route ordering matters to avoid redirect loops. Order: auth, onboarding, my-day, analytics, settings, profile, team-directory, [entity routes], dashboard-redirect, empty-redirect, wildcard

    4. Update login component `globcrm-web/src/app/features/auth/pages/login/login.component.ts`:
       - Line 46: Change `private returnUrl = '/dashboard'` to `private returnUrl = '/my-day'`
       - Line 49: Change fallback `|| '/dashboard'` to `|| '/my-day'`

    5. Update two-factor component `globcrm-web/src/app/features/auth/pages/two-factor/two-factor.component.ts`:
       - Line 202: Change `this.router.navigate(['/dashboard'])` to `this.router.navigate(['/my-day'])`
  </action>
  <verify>
    - `cd globcrm-web && npx ng build --configuration=development 2>&1 | tail -5` compiles without errors
    - Grep for '/dashboard' in login.component.ts and two-factor.component.ts returns zero matches (only '/my-day')
    - app.routes.ts contains 'my-day', 'analytics', and `dashboard.*redirectTo.*analytics`
  </verify>
  <done>
    - /my-day route exists and loads MyDayComponent placeholder
    - /analytics route loads existing DashboardComponent (org dashboard)
    - /dashboard redirects to /analytics (backward compatibility)
    - / and /** redirect to /my-day
    - Login redirects to /my-day after successful auth
  </done>
</task>

<task type="auto">
  <name>Task 2: Update sidebar navigation with My Day and Analytics menu items</name>
  <files>
    globcrm-web/src/app/shared/components/navbar/navbar.component.ts
  </files>
  <action>
    Update `navGroups` array in `navbar.component.ts`:

    1. Change the first group (currently unnamed with Dashboard + Reports) to:
       ```typescript
       {
         label: '',
         items: [
           { route: '/my-day', icon: 'home', label: 'My Day' },
           { route: '/analytics', icon: 'grid_view', label: 'Analytics' },
           { route: '/reports', icon: 'bar_chart', label: 'Reports' },
         ]
       },
       ```
       - "My Day" gets the `home` icon (Material icon: home) as the first item — this is the personal dashboard
       - "Analytics" replaces "Dashboard" with the same `grid_view` icon — this is the org analytics dashboard
       - "Reports" stays unchanged in the same group

    2. No other nav groups change. CRM, Work, Connect, Admin groups remain identical.
  </action>
  <verify>
    - `cd globcrm-web && npx ng build --configuration=development 2>&1 | tail -5` compiles without errors
    - Grep navbar.component.ts for 'my-day' returns a match
    - Grep navbar.component.ts for '/dashboard' returns zero matches (replaced with /analytics)
  </verify>
  <done>
    - Sidebar shows "My Day" with home icon as first navigation item
    - Sidebar shows "Analytics" (formerly "Dashboard") with grid_view icon
    - Clicking "My Day" navigates to /my-day
    - Clicking "Analytics" navigates to /analytics (the org dashboard)
  </done>
</task>

</tasks>

<verification>
1. Build passes: `cd globcrm-web && npx ng build --configuration=development`
2. No references to old '/dashboard' route in login, two-factor, or navbar components
3. app.routes.ts has correct ordering: my-day before analytics, analytics before dashboard redirect, dashboard redirect before default ''
4. Backward compatibility: /dashboard path has redirectTo: 'analytics'
</verification>

<success_criteria>
- App compiles successfully with restructured routes
- /my-day is the default route ('' redirectTo 'my-day')
- /analytics loads the existing org dashboard
- /dashboard redirects to /analytics for backward compatibility
- Sidebar nav shows "My Day" (home icon) and "Analytics" (grid_view icon)
- Login flow redirects to /my-day
</success_criteria>

<output>
After completion, create `.planning/phases/24-my-day-personal-dashboard/24-01-SUMMARY.md`
</output>
